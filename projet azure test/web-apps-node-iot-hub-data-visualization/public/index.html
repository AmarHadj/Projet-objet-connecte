<!doctype html>

<html lang="en">
<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <link href="css/style.css" rel="stylesheet" /> 

    
    <title>Contrôle d'une serre</title>
</head>

<body style="text-align:center; margin: 0px;">

    <div class="mycenter" id="">
      <h2 style="text-align:center;" class ="title">Contrôle d’une porte d’aération d’une serre</h2>
      <label class ="temp_value" name="temp">Température ambiante : </label>
      <label id="tempValue" class="temp" name="tempValue"><span id="tempVal"></span></label><br><sbr>
      <label class ="control" id="ctrl" name ="ctrl">Contrôle :</label>
      <input type="button" class="button_auto" value="automatique" id="Auto"/>
      <input type="button" class="button_Manual" value="manuelle" id = "Manuel"/>
      <input type="text" class="pourcentage_Manual" id="pourcentage_Manual" name="pourcentageManu" value="">
      <label class ="action" id="act" name ="ctrl">Action :</label><br><br>
      <input type="button" class="button_open" value="Ouvrir la porte" id = "Open"/>
      <input type="button" class="button_close" value="Fermer la porte" id = "Close"/>
      <a href="graph.html">
        <input type="button" class="button_graph" value="Graphique de températures et
de pourcentages par période" />
      </a>
      
    </div>

    <div class="loadbar">
      <strong class="bar" id="pourcentageOpening"></strong>
    </div>   
    </body>

</html>

<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
  <script>
    var ws = new WebSocket("ws://localhost:3000");
    var temp = document.getElementById("tempValue");
    var pourcentageOpening = document.getElementById("pourcentageOpening");
    var Control = document.getElementById("controlValue");

    ws.onmessage = function(event){

      console.log(event);
      var Myarray = event.data.split("/");
      temp.innerHTML = Myarray[0];
      pourcentageOpening.innerHTML = Myarray[1];
      document.getElementById("pourcentageOpening").style = "height:" + Myarray[1] +"%;";
      
      document.getElementById("pourcentage_Manual").value = Myarray[3];
      
      document.getElementById("Auto").style.background = '#ffffff'
      document.getElementById("Manuel").style.background = '#ffffff'
      document.getElementById("Open").style.background = '#ffffff'
      document.getElementById("Close").style.background = '#ffffff'

      switch(Myarray[2]){        
        
        case "auto" :
          document.getElementById("Auto").style.background = '#00b050'
          break;

        case "manual" :
          document.getElementById("Manuel").style.background = '#00b050'
          break;

        case "open" :
          document.getElementById("Open").style.background = '#00b050'
          break;

        case "close" :
          document.getElementById("Close").style.background = '#00b050'
          break;
      }

      
      


    }
  </script>
</head>
<!-- <body onload="GetTemp()"> -->